/*
* This Source Code Form is subject to the terms of the Mozilla Public
* License, v. 2.0. If a copy of the MPL was not distributed with this
* file, You can obtain one at https://mozilla.org/MPL/2.0/.
*/

/* =====================================================================
Card Grid - Flare 2026 Design System Cards
===================================================================== */

/* The idea with the card grid is that we'll adjust the container based
   on how many cards are present, and also the container size. We're setting
   reasonable defaults, and then adjusting with :has() based on which
   type of card is being used. The selectors are a little complicated,
   but this allows us to make the card list component in the CMS completely
   agnostic to which card type it contains.
*/

.fl-card-grid {
    --fl-card-grid-gap: var(--token-spacing-3xl) var(--token-spacing-lg);
    --fl-card-sticker-size: 60px;
    display: grid;
    gap: var(--fl-card-grid-gap);
    grid-template-columns: var(--fl-card-grid-columns, minmax(0, 1fr));
    justify-content: center;
    padding-block: var(--token-layout-3xs);
}

/* default usage of illustration cards get two-wide on mobile. */
.fl-card-grid:has(.fl-illustration-card-default) {
    --fl-card-grid-columns: repeat(2, minmax(0, 1fr));
}

@media (--viewport-sm-up) {
    /* for most instances, tablet size gets two-wide cards */
    .fl-card-grid {
        --fl-card-grid-columns: repeat(2, minmax(0, 1fr));
    }

    /* when a card grid only has two items, reduce the max width and center it. */
    .fl-card-grid:has(> *:nth-child(2):last-child) {
        --fl-card-grid-columns: repeat(2, minmax(0, 1fr));
        margin-inline: auto;
        max-inline-size: var(--token-width-desktop-content);
    }

    /* The features theme page has a unique design for the illustration
       icon cards, where they are two wide on desktop. */
    .fl-features-theme-page .fl-card-grid:has(.fl-illustration-icon-card) {
        --fl-card-grid-columns: repeat(2, minmax(0, 1fr));
        margin-inline: auto;
        max-inline-size: var(--token-width-desktop-content-lg);
    }
}

@media (--viewport-md-up) {
    /* The default assumes four cards */
    .fl-card-grid {
        --fl-card-grid-columns: repeat(4, minmax(0, 1fr));
    }

    /* when there are three cards, let them fill the space. */
    .fl-card-grid:has(> *:nth-child(3):last-child) {
        --fl-card-grid-columns: repeat(3, minmax(0, 1fr));
    }

    /* These are used on features/all. The design is specified at 3 wide max. */
    .fl-card-grid:has(.fl-illustration-sticker-card) {
        --fl-card-grid-columns: repeat(3, minmax(0, 1fr));
    }

    /* default usage of illustration cards assumes four wide... */
    .fl-card-grid:has(.fl-illustration-card-default) {
        --fl-card-grid-columns: repeat(4, minmax(0, 1fr));
    }

    /* ...unless there are only three, and then it gets a special treatment.
       There are two selectors, one with and one without .conditional-passthrough
       or .image-variants. */
    .fl-card-grid:has(.fl-illustration-card-default:nth-child(3):last-child),
    .fl-card-grid:has(
        > *:nth-child(3):last-child .fl-illustration-card-default
    ) {
        --fl-card-grid-columns: repeat(3, minmax(0, 1fr));
        inline-size: 100%;
        margin-inline: auto;
        max-inline-size: var(--token-width-desktop-content-lg);
    }
}

.fl-card-heading .fl-heading-group {
    display: flex;
    flex-direction: column;
    gap: var(--token-spacing-xl);
    order: 0;
}

.fl-card-superheading {
    color: var(--fl-theme-card-superheading-color);
    font-size: var(--fl-theme-font-size-body-2xs);
    margin: 0;
    text-transform: uppercase;
}

.fl-card-expand-link {
    cursor: pointer;
}

.fl-card-heading-link {
    color: inherit;
    text-decoration: none;
}

.fl-card-heading-link:hover .fl-heading,
.fl-card-heading-link:focus .fl-heading,
.fl-card-heading-link:active .fl-heading {
    text-decoration: underline;
}

.fl-card-expand-link a::after,
.fl-card-expand-link button::after {
    content: '';
    inset: 0;
    position: absolute;
}

.fl-card-expand-link:hover
    :is(
        h1.fl-heading,
        h2.fl-heading,
        h3.fl-heading,
        h4.fl-heading,
        h5.fl-heading,
        h6.fl-heading
    ) {
    text-decoration: underline;
}

.fl-body a {
    color: var(--fl-theme-color-text);
    text-decoration: none;
}

/* =====================================================================
Basic Card
===================================================================== */

.fl-card {
    align-items: stretch;
    backdrop-filter: blur(7.5px);
    background: var(--fl-theme-surface-card-gradient);
    border: 1px solid var(--card-border-color);
    border-radius: var(--token-border-radius-sm);
    box-shadow: var(--fl-theme-shadow-card);
    color: var(--token-color-black-4);
    padding: var(--token-spacing-2xl);
    position: relative;
    transition:
        transform var(--token-transition-base),
        box-shadow var(--token-transition-base);
}

.fl-card:hover {
    box-shadow: 0 40px 96px var(--token-color-dark-purple-22);
    transform: translateY(-2px);
}

.fl-card .fl-heading-group {
    gap: unset;
    margin: 0;
    padding: 0;
}

/* =====================================================================
Sticker Card
===================================================================== */

.fl-sticker-card {
    align-items: stretch;
    backdrop-filter: blur(7.5px);
    background: var(--fl-theme-surface-card-gradient);
    block-size: auto;
    border-radius: var(--token-border-radius-md);
    box-shadow: var(--fl-theme-shadow-card);
    color: var(--token-color-black-4);
    display: flex;
    flex-direction: column;
    gap: var(--token-spacing-xl);
    justify-content: flex-start;
    min-block-size: 480px;
    padding: var(--token-spacing-2xl) var(--token-spacing-2xl)
        var(--token-spacing-3xl);
    position: relative;
    text-align: center;
    transition:
        transform var(--token-transition-base),
        box-shadow var(--token-transition-base);
}

.fl-sticker-card:hover {
    box-shadow: 0 40px 96px var(--token-color-dark-purple-22);
    transform: translateY(-2px);
}

.fl-sticker-card .fl-heading {
    color: var(--token-color-black-4);
}

.fl-sticker-card .fl-heading-group {
    color: var(--token-color-black-4);
    gap: unset;
    margin: 0;
    padding: 0;
}

.fl-sticker-card
    > :is(
        h1.fl-heading,
        h2.fl-heading,
        h3.fl-heading,
        h4.fl-heading,
        h5.fl-heading,
        h6.fl-heading,
        .fl-heading-group
    ) {
    margin-block-end: 0;
    order: 0;
}

.fl-card-sticker {
    margin: auto;
    order: 1;
}

.fl-sticker-card > div:has(.fl-card-sticker) {
    order: 2;
}

.fl-sticker-card > .fl-body {
    order: 3;
}

.fl-sticker-card > .fl-buttons {
    order: 4;
}

.fl-sticker-card > div:has(.fl-card-sticker),
.fl-sticker-card > div:has(.fl-card-icon),
.fl-sticker-card > div:has(.fl-tag) {
    align-items: center;
    display: flex;
    flex: 1 1 auto;
    gap: var(--token-spacing-sm);
    inline-size: 100%;
    justify-content: center;
}

.fl-sticker-card
    :is(
        h1.fl-heading,
        h2.fl-heading,
        h3.fl-heading,
        h4.fl-heading,
        h5.fl-heading,
        h6.fl-heading
    ) {
    color: inherit;
    font-family: var(--fl-theme-font-family-headline);
    font-weight: var(--token-font-weight-semibold);
    letter-spacing: -0.01em;
    line-height: 1.05;
    margin: 0;
}

.fl-sticker-card .fl-superheading {
    color: var(--token-color-light-purple);
    display: block;
    font-family: var(--fl-theme-font-family-body);
    font-size: var(--fl-theme-font-size-body-2xs);
    font-weight: var(--token-font-weight-medium);
    letter-spacing: 0.02em;
    margin: 0 0 var(--token-spacing-xl);
    text-transform: uppercase;
}

.fl-sticker-card .fl-body > * {
    font-family: var(--fl-theme-font-family-body);
    font-size: var(--fl-theme-font-size-body-sm);
    font-weight: var(--token-font-weight-regular);
    line-height: 1.4;
    text-wrap: balance;
}

.fl-sticker-card .fl-body > *:first-child {
    margin-block-start: 0;
}

.fl-sticker-card .fl-body > *:last-child {
    margin-block-end: 0;
}

.fl-sticker-card .fl-buttons {
    align-items: center;
    display: flex;
    flex-wrap: wrap;
    gap: var(--token-spacing-lg);
    justify-content: center;
    margin-block-start: var(--token-spacing-lg);
}

.fl-sticker-card .fl-buttons:empty {
    display: none;
}

.fl-sticker-card .fl-button {
    margin: 0;
}

.fl-card-sticker img {
    block-size: var(--fl-card-sticker-size, 60px);
    inline-size: var(--fl-card-sticker-size, 60px);
    margin: 0;
    object-fit: contain;
}

.fl-sticker-card > div:has(.fl-card-icon) {
    color: var(--token-color-light-purple);
}

.fl-sticker-card.fl-card-fill {
    background: var(--token-gradient-soft-purple);
}

/* =====================================================================
Step Cards List - With Kit variant
===================================================================== */

/*
 * Scoped styling hook applied to the Cards List wrapper:
 *   <div class="fl-card-grid fl-step-cards-with-kit">...</div>
 *
 */

.fl-card-grid.fl-step-cards-with-kit {
    gap: var(--token-layout-2xs);
    inline-size: 100%;
    justify-content: center;
    margin: 0 auto;
    max-inline-size: var(--token-width-desktop-wide-banner);
}

.fl-step-card {
    display: flex;
    flex-direction: column;
    gap: var(--token-spacing-xl);
    position: relative;
}

.fl-step-card .fl-card-media {
    align-items: center;
    background: var(--fl-step-card-bg);
    border-radius: var(--token-layout-xs);
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    gap: var(--token-spacing-2xl);
    inline-size: 100%;
    justify-content: center;

    /* Figma: 240px on desktop, but keep responsive */
    min-block-size: calc(var(--token-layout-md) * 3);
    overflow: hidden;
    padding: var(--token-spacing-2xl);
}

.fl-step-card .fl-card-media img {
    block-size: auto;
    inline-size: auto;
    max-block-size: 96px;
    max-inline-size: 100%;
    object-fit: contain;
}

.fl-step-card-index {
    align-items: center;
    background: var(--fl-step-card-index-bg);
    block-size: var(--token-layout-3xs);
    border-radius: var(--token-layout-3xs);
    box-sizing: border-box;
    color: var(--fl-theme-color-text);
    display: flex;
    font-size: 12px;
    font-weight: var(--token-font-weight-medium);
    inline-size: var(--token-layout-3xs);
    justify-content: center;
    margin: 0;
    padding: var(--token-spacing-sm);
}

.fl-step-card .fl-heading-group {
    margin: 0;
}

.fl-step-card .fl-heading {
    font-size: var(--token-spacing-lg);
    font-weight: var(--token-font-weight-semibold);
    letter-spacing: 0;
    line-height: 1.1;
    margin: 0;
    text-wrap: auto;
}

/* Decorative Kit (Figma): only on the last card */
.fl-step-cards-with-kit .fl-step-card:last-child {
    margin-block-start: var(--token-layout-sm);
}

.fl-step-cards-with-kit .fl-step-card:last-child::before,
.fl-step-cards-with-kit .fl-step-card:last-child::after {
    background-repeat: no-repeat;
    background-size: auto;
    content: '';
    inset-block-start: -32px;
    pointer-events: none;
    position: absolute;
    z-index: 3;
}

.fl-step-cards-with-kit .fl-step-card:last-child::before {
    background-image: url('/media/img/firefox/flare/fox-tail.png');
    background-size: contain;
    block-size: 110px;
    inline-size: 68px;
    inset-inline-start: -20px;
}

.fl-step-cards-with-kit .fl-step-card:last-child::after {
    background-image: url('/media/img/firefox/flare/fox-head.png');
    background-size: contain;
    block-size: 86px;
    inline-size: 98px;
    inset-block-start: -60px;
    inset-inline-end: 0;
}

@media (--viewport-md-up) {
    .fl-card-grid.fl-step-cards-with-kit {
        gap: var(--token-layout-lg) var(--token-layout-3xs);
    }

    .fl-step-cards-with-kit .fl-step-card:last-child {
        margin-block-start: 0;
    }
}

/* =====================================================================
Illustration Card
===================================================================== */

.fl-illustration-card {
    display: flex;
    flex-direction: column;
    padding: 0;
    position: relative;
}

.fl-illustration-card .fl-heading-group {
    display: flex;
    flex-direction: column;
    gap: var(--token-spacing-lg);
    margin: 0;
}

.fl-illustration-card .fl-heading-group .fl-superheading {
    margin: 0;
}

.fl-illustration-card .fl-card-media,
.fl-illustration-card .fl-card-media img {
    border-radius: var(--token-spacing-xl);
    inline-size: 100%;
}

.fl-illustration-card .fl-card-content {
    display: flex;
    flex-direction: column;
    flex-grow: 1;
    gap: var(--token-spacing-lg);
}

.fl-illustration-card .fl-heading,
.fl-illustration-card .fl-body {
    margin: 0;
}

.fl-illustration-card .fl-buttons {
    margin-block-start: auto;
}

.fl-illustration-card .fl-superheading {
    color: var(--fl-theme-color-brand-text);
    display: block;
    font-size: var(--fl-theme-label-xs);
    font-weight: var(--token-font-weight-medium);
    margin-block-end: var(--token-spacing-sm);
}

.fl-illustration-card .fl-heading {
    font-size: var(--fl-theme-font-size-heading-2xs);
    font-variation-settings: unset;
    line-height: 1.1;
}

.fl-illustration-card.fl-illustration-icon-card,
.fl-illustration-card.fl-illustration-sticker-card {
    --media-padding: var(--token-spacing-md);
    flex-direction: column;
    gap: var(--token-spacing-xl);
}

.fl-illustration-card.fl-illustration-sticker-card {
    --media-size: 56px;
    --media-border-radius: var(--token-border-radius-xs);
}

.fl-illustration-card.fl-illustration-icon-card {
    --media-size: 48px;
    --media-border-radius: var(--token-border-radius-2xs);
}

.fl-illustration-card.fl-illustration-icon-card img,
.fl-illustration-card.fl-illustration-sticker-card img {
    border-radius: 0;
    margin: 0;
    max-block-size: 100%;
    max-inline-size: 100%;
}

.fl-illustration-card.fl-illustration-icon-card .fl-card-media,
.fl-illustration-card.fl-illustration-sticker-card .fl-card-media {
    align-items: center;
    background-color: var(--fl-theme-illustration-icon-bg);
    block-size: var(--media-size);
    border-radius: var(--media-border-radius);
    display: flex;
    inline-size: var(--media-size);
    justify-content: center;
    min-block-size: var(--media-size);
    min-inline-size: var(--media-size);
    padding: var(--media-padding);
}

@media (--viewport-md-up) {
    .fl-illustration-card.fl-illustration-sticker-card {
        --media-border-radius: var(--token-border-radius-sm);
        --media-padding: var(--token-spacing-lg);
        --media-size: 102px;
    }
}
